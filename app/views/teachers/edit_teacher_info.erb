<div class="container">
  <div class="panel panel-default">
    <div class="panel-body">
      <legend>학습 프로필</legend>
      <%= form_for :teacher_info, url: update_teacher_info_path, html: {id: "edit_form"} do |f| %>
        <!-- location 우선 제거, 필요 시 개인 프로필에 추가
        <div class="col-md-2" align="center">
          <%#= f.label :location, "Location", class: "control-label" %>
        </div>
        <div class="col-md-10">
          <%#= f.text_field :location, :autocomplete => :off, class: "col-md-12 form-control" %>
        </div>
        -->
        
        <!-- 줄바꿈용 div 우선 제거
        <div class="col-md-12" style="height: 10px"></div>
        -->
        
        <!-- major 제거
        <div class="col-md-2" align="center">
          <%#= f.label :major, "Major", class: "control-label" %>
        </div>
        <div class="col-md-4">
          <%#= f.text_field :major, :autocomplete => :off, class: "col-md-12 form-control" %>
        </div>
        -->
        
        <!-- University 제거
        <div class="col-md-2" align="center">
          <%#= f.label :school_grad, "University graduated", class: "control-label" %>
        </div>
        <div class="col-md-4">
          <%#= f.text_field :school_grad, :autocomplete => :off, class: "col-md-12 form-control" %>
        </div>
        -->
        
        <!-- 줄바꿈용 div 우선 제거
        <div class="col-md-12" style="height: 10px"></div>
        -->
        
        <div class="form-group">
          <%= f.label :lecture_price, "강의료 설정", class: "col-md-2 control-label" %>
          <div class="col-md-10">
            <%= f.text_area :lecture_price, :autocomplete => :off, :placeholder => "10코인 이하로 설정해주세요.", class: "form-control", rows: "1" %>
          </div>
        </div>  
        <div class="col-md-12" style="height:10px"></div>
        
        <div class="form-group">
          <%= f.label :skype_id, "스카이프 아이디", class: "col-md-2 control-label" %>
          <div class="col-md-10">
            <%= f.text_area :skype_id, autocomplete: "off", :placeholder => "스카이프 아이디", class: "form-control", rows: "1" %>
          </div>
        </div>
        <div class="col-md-12" style="height:10px"></div>
        
        <div class="form-group">
          <%= f.label :brief_introduction, "짧은 소개글", class: "col-md-2 control-label" %>
          <div class="col-md-10">
            <%= f.text_area :brief_introduction, :autocomplete => :off, :placeholder => "간단하게 자신을 소개해주세요. 선생님 검색 목록에 표시되는 소개글입니다.", class: "col-md-12 form-control", rows: "2" %>
          </div>
        </div>
        <div class="col-md-12" style="height:10px"></div>
        
        <div class="form-group">
          <%= f.label :introduction, "긴 소개글", class: "col-md-2 control-label" %>
          <div class="col-md-10">
            <%= f.text_area :introduction, :autocomplete => :off, :placeholder => "강사로서의 장점, 강사로서의 경험, 강의 방식 등을 자세히 소개해 주세요. 강사 페이지에 표시되는 소개글입니다.", class: "col-md-12 form-control", rows: "15" %>
          </div>
        </div>
        <div class="col-md-12" style="height:10px"></div>
        
        <div class="form-group">
          <label class="col-md-2 control-label" style="padding-top:25px">강의시간표 설정</label>
          <div class="col-md-10">
            <div class="row">
              <div class="col-md-12">
                <table class="table table-striped" style="table-layout: fixed;">
                  <thead>
                    <tr>
                      <% ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'].each do |item| %>
                        <th><%= item %></th>
                      <% end %>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <% ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturday'].each do |item| %>
                        <td>
                          <p class='wday_td' id="<%= item %>_td">
                          </p>
                          <a class="schedule_add_trigger" data-toggle="modal" data-target="#schedule_modal" data-wday="<%= item %>">
                            +add schedule
                          </a>
                        </td>
                      <% end %>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
          </div>
          <div class="modal fade" id="schedule_modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">시간표 설정</h4>
                </div>
                <div class="modal-body">
                  <div class="row">
                    <div class="col-md-4">
                      <span id="wd_text"></span>
                    </div>
                    <div class="col-md-4">
                      시작 시간
                      <input name="start-time" type="time" class="form-control"> 
                    </div>
                    <div class="col-md-4">
                      종료 시간
                      <input name="end-time" type="time" class="form-control">
                    </div>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                  <button id="schedule_add_btn" type="button" class="btn btn-primary" data-dismiss="modal" disabled>Save</button>
                </div>
              </div>
            </div>
          </div>
          <div class="col-md-10 col-md-offset-2">강의 신청을 받을 수 있는 시간대를 요일별로 설정해주세요.</div>
          <input type="hidden" name="week-day">
          <input type="hidden" name="schedules" id="schedules">
          <div class="col-md-10 col-md-offset-2" style="margin-top: 2rem; margin-bottom: 4rem;">
            <%= f.submit "완료", class: "col-md-3 btn btn-primary" %>
          </div>
        </div>

      <% end %>
    </div>
  </div>
</div>

<script src="/assets/mySchedule.js"></script>
<script type="text/javascript">
  my_schd = new Teacher_Schedule('<%= current_user.get_schedule %>');
  $(document).ready(function(){
    my_schd.show_schedules();

    $('input[name="start-time"]').change(function(){
      check_add_btn();
    });

    $('input[name="end-time"]').change(function(){
      check_add_btn();
    });

    $('.schedule_add_trigger').click(function(){
      $('#wd_text').text($(this).data('wday'));
      $('input[name="week-day"]').val($(this).data('wday'));
    });

    $('#schedule_add_btn').click(function(){
      my_schd.push_schedule($('input[name="week-day"]').val(), $('input[name="start-time"]').val(), $('input[name="end-time"]').val())
      $('input[name="start-time"]').val('');
      $('input[name="end-time"]').val('');
      my_schd.show_schedules();
    });

    $(document).on('click', '.schedule_delete_btn', function(){
      if(confirm('Are U sure?')){
        my_schd.delete_schedule($(this).data('schedule'));
        my_schd.show_schedules();
      };
    });

    $('#edit_form').submit(function(e){
      $('#schedules').val(my_schd.get_schedule().join(','));
    });

  });
</script>
